<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[TRACTATUS ELEMENTALIS]]></title>
  <link href="https://tractatuslapipaplena.herokuapp.com/atom.xml" rel="self"/>
  <link href="https://tractatuslapipaplena.herokuapp.com/"/>
  <updated>2013-11-19T18:28:53+01:00</updated>
  <id>https://tractatuslapipaplena.herokuapp.com/</id>
  <author>
    <name><![CDATA[templix]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[iptables]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/iptables/"/>
    <updated>2013-11-19T18:28:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/iptables</id>
    <content type="html"><![CDATA[<p>herramienta de cortafuegos y trafico de red.</p>

<p>Algunos ejemplos generales:</p>

<pre><code># iptables -F (eliminar todas las reglas)

# iptables -L (si está activo y con qué reglas)

# iptables -L -vn (mostrando los puertos e información detallada)

# iptables -L -t nat (Listar reglas de una tabla concreta)

# iptables -L fail2ban-ssh (comprobar las ips bloqueadas por fail2ban)

# iptables -D fail2ban-ssh 1 (Quitar la primera ip baneada de las ips bloqueadas)

# iptables -nL --line-numbers (muestra el orden de ejecución de las reglas)

# iptables -nL INPUT (Lista todas las reglas de entrada)

# iptables -nL FORWARD (Lista todas las reglas de salida)

# iptables -D INPUT 3 (borrar la regla número 3)

# iptables -A INPUT -j LOG (Guardar logs de todos los bloqueos)
</code></pre>

<p>Bloquear (DROP)</p>

<pre><code># iptables -P INPUT DROP (Bloquear todo lo que entra)

# iptables -A INPUT -s IP -j DROP (una ip)

# iptables -A INPUT -s IP -i eth0 -j DROP (una ip de una red)

# iptables -A INPUT -s IP -p tcp -dport 22 -j DROP (un puerto de una ip) 

# iptables -A INPUT -s 192.168.1.0/24 -j DROP (una red)

# iptables -A INPUT -m mac --mac-source 00:11:22:33:44:55 -j DROP (una mac)

# iptables -A INPUT -p tcp --destination-port 21 -j DROP (puerto 21 de entrada)

# iptables -A INPUT -p tcp -s IP --destination-port 21 -j DROP (el puerto 21 de entrada sólo para una IP)

# iptables -A INPUT -p tcp -i eth0 -m multiport --destination-port 22,80,443 -j ACCEPT (Varios puertos)

# iptables -A INPUT p tcp -s 192.168.1.0/24 --destination-port 21 -j DROP (el  puerto 21 de entrada para todo un rango de IPs)

# iptables -A FORWARD -p tcp --dport 25 -j DROP (la salida del puerto 25)

# iptables -A INPUT -p tcp --dport 22 -j LOG --log-prefix "Puerto 22 bloqueado" iptables -A INPUT -p tcp --dport 22 -j DROP (haciendo aparecer una mensaje informando del bloqueo)
</code></pre>

<p>Permitir (ACCEPT)</p>

<pre><code># iptables -I INPUT 3 -s 192.168.1.0/8 -j ACCEPT (a la red especificada y poner la regla en tercer lugar)

# iptables -D INPUT -s 192.168.1.0/8 -j ACCEPT (Quitar la regla anterior) 

# iptables -A INPUT -i lo -p all -j ACCEPT (todas las entradas a localhost)

# iptables -A OUTPUT -o lo -p all -j ACCEPT (todas las salidas a localhost)

# iptables -A INPUT -p tcp --dport ssh -j ACCEPT (Un servicio concreto)

# iptables -A INPUT -p tcp -i eth0 -m multiport --destination-port 22,80,443 -j ACCEPT (Todas las entradas a varios puertos)

# iptables -A OUTPUT -o eth0 -p tcp -d 192.168.101.0/24 --dport 22 -j ACCEPT  (Permitir trafico ssh saliente para la red especificada)  
</code></pre>

<p>1.-</p>

<p>Salvar unas reglas de iptables y restablecerlas manualmente:</p>

<blockquote><p># iptables-save -c > /etc/iptables.rules</p>

<p># iptables-restore &lt; /etc/iptables.rules</p></blockquote>

<p>2.-</p>

<p>Salvar unas reglas de iptables para que se activen automaticamente tras un reinicio:</p>

<p>Salvar las reglas:</p>

<blockquote><p># iptables-save > /etc/iptables/rules.v4</p></blockquote>

<p>Crear el archivo:</p>

<blockquote><p># nano /etc/network/if-pre-up.d/iptables (Crear archivo)</p></blockquote>

<p>Con el siguiente contenido:</p>

<pre><code>#!/bin/bash

/sbin/iptables-restore &lt; /etc/iptables/rules.v4
</code></pre>

<p>Otorgar permisos:</p>

<blockquote><p># chmod +x /etc/network/if-pre-up.d/iptables</p></blockquote>

<p>3.-</p>

<p>Otra opción para salvar las reglas y que se activen tras un reinicio:</p>

<blockquote><p># /etc/init.d/iptables-persistent save (Guardar las reglas existentes)</p>

<p># /etc/init.d/iptables-persistent flush (Reseteará todas las reglas)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[gdm]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/gdm/"/>
    <updated>2013-11-19T18:28:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/gdm</id>
    <content type="html"><![CDATA[<p>Pantalla de login para entrar en el sistema</p>

<p>1-</p>

<p>Para ocultar usuarios:</p>

<p>Aparecen en la pantalla de login los que tienen un ID 1000 o superior. Para conocer los ID:</p>

<blockquote><p># cat /etc/passwd | gawk -F: &#8216;{print $3, $1}&#8217; | sort -n</p></blockquote>

<p>Para suprimirlos:</p>

<blockquote><p># nano /etc/gdm/custom.conf</p></blockquote>

<p>Y el apartado greeter dejarlo:</p>

<p>[greeter]</p>

<p>Exclude=usuario_a_ocultar,boinc,yacy</p>

<p>2.-</p>

<p>Entrada automática y otros ajustes:</p>

<blockquote><p># gdmsetup</p></blockquote>

<p>3.-</p>

<p>Cambiar fondo en la pantalla de login.</p>

<blockquote><p># nano /etc/gdm3/greeter.gsettings</p></blockquote>

<p>Y modificando la linea &#8220;pictori-uri&#8221; para que apunte a la imagen deseada:</p>

<pre><code>[org.gnome.desktop.background]

picture-uri='file:///path/a/fondo'

picture-options='zoom'
</code></pre>

<p>Una vez modificado, aplicar los cambios con:</p>

<blockquote><p># dpkg-reconfigure gdm3</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[funcoeszz]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/funcoeszz/"/>
    <updated>2013-11-17T21:11:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/funcoeszz</id>
    <content type="html"><![CDATA[<p>Conjunto de 65 funciones y utilidades varias. Una vez instalado:</p>

<blockquote><p>$ funcoeszz zzzz &#8211;bashrc (Para colocar las lineas en .bashrc)</p></blockquote>

<pre><code># Instalacao das Funcoes ZZ (www.funcoeszz.net)

source /usr/bin/funcoeszz

export ZZPATH=/usr/bin/funcoeszz
</code></pre>

<blockquote><p>$ source .bashrc (Releer el fichero)</p>

<p>$ funcoeszz zzzz (listado de los 65 funciones)</p>

<p>$ funcoeszz zzzz &#8211;teste (Comprobar que todos los ejecutables que necesita la aplicación estan instalados)</p>

<p>$ funcoeszz zzzz &#8211;atualiza (Baja las últimas versiones de las funciones)</p>

<p>$ funcoeszz ajuda (Ayuda muy util sobre como usar cada un de las funciones)</p>

<p>$ funcoeszz ascii (Lanzar una de las funciones del listado)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[nstat]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/nstat/"/>
    <updated>2013-11-17T16:24:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/nstat</id>
    <content type="html"><![CDATA[<p>Muestra las estadísticas de la red.</p>

<blockquote><p>$ nstat</p>

<p>$ nstat -z (Mostrando los contadores a cero. Por defecto no se muestran)</p>

<p>$ nstat -a (Volcado absoluto de todos los contadores)</p>

<p>$ nstat -r (Resetear los contadores)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[vnstati]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/vnstati/"/>
    <updated>2013-11-17T16:13:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/vnstati</id>
    <content type="html"><![CDATA[<p>[vnstat]</p>

<p>Crea un png de la salida del comando vnstat.</p>

<blockquote><p>$ vnstati -s -vs -i eth1 -o vnstat.png (Mostrando resumen del tráfico de salida [s], incluyendo datos por hora en gráfica vertical [vs], especificando la red y guardando en vnstat.png [o])</p>

<p>$ vnstati -h -c 15 -o vnstat2.png (por horas [h] y actualizando si han pasado 15 minutos del último reporte)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[rzip]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/rzip/"/>
    <updated>2013-11-17T12:48:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/rzip</id>
    <content type="html"><![CDATA[<p>Compresor/descompresor. Crea los comprimidos con extensión .rz</p>

<blockquote><p>$ rzip archivo.txt (Substituye archivo.txt por archivo.txt.rz)</p>

<p>$ rzip -o archivo.txt -d archivo.txt.rz (Descomprimir. Imprescindible dar el nombre del archivo de salida [-o])</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[rl]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/rl/"/>
    <updated>2013-11-17T12:48:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/rl</id>
    <content type="html"><![CDATA[<p>[randomize-lines]</p>

<p>Muestra lineas de un archivo o de la entrada standard de forma aleatoria.</p>

<blockquote><p>$ rl /etc/fstab (Forma básica)</p>

<p>$ seq 10 | rl &#8211;count 2 (2 números del 0 al 10)</p>

<p>$ rl -n /etc/fstab -o archivo (Numerando las lineas, colocandolas de forma aleatoria y guardando el resultado en &#8220;archivo&#8221;)</p>

<p>$ rl -o archivo -c 5 archivo.txt (Guardar en archivo [-o] 5 lineas [-c] del texto archivo.txt)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[freeradius]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/freeradius/"/>
    <updated>2013-11-17T12:48:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/freeradius</id>
    <content type="html"><![CDATA[<p>[libssl-dev freeradius-mysql freeradius-utils]</p>

<p>Servidor.</p>

<p>Configurar la base de datos:</p>

<blockquote><p># nano /etc/freeradius/sites-enabled/default</p></blockquote>

<p>En los apartados &#8220;authorize&#8221; y &#8220;accouting&#8221; descomentar las lineas sql</p>

<blockquote><p># nano /etc/freeradius/radius.conf</p></blockquote>

<p>Descomentar la linea $INCLUDE sql.conf</p>

<p>Configurar usuario, contraseña y mensaje de bienvenida:</p>

<blockquote><p># nano /etc/freeradius/users</p></blockquote>

<p>USUARIO Cleartext-Password := &#8220;CONTRASEÑA&#8221;</p>

<pre><code>    Reply-Message "Entrando en el servidor el usuario %{User_Name}"
</code></pre>

<p>Configurar usuario y contraseña del router o punto de acceso:</p>

<blockquote><p># nano /etc/freeradius/clients.conf</p></blockquote>

<p>client 192.168.1.0/24 {</p>

<pre><code>secret      = CONTRASEÑA_ROUTER

shortname   = USUARIO_ROUTE
</code></pre>

<p>Finalmente entrar en router y colocar la ip del equipo donde hemos instalado el servidor. Reiniciar el servicio.</p>

<blockquote><p># /etc/init.d/freeradius restart</p>

<p># freeradius -X (Arrancar em modo debug)</p>

<p># radtest USUARIO testing 127.0.0.1 1812 testing123 (Testear si la configuración de un usuario está correcta)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Copy]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/copy/"/>
    <updated>2013-11-17T12:48:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/copy</id>
    <content type="html"><![CDATA[<p>Carpetas en la nuve tipo Dropbox. Entrar en http://www.copy.com despues de registrarse y logearse, clicar en la pestaña &#8220;Install App&#8221; con lo que se nos descargará la aplicacion de escritorio.</p>

<blockquote><p>$ tar -zvxf copy_agent-1.28.0657.tgz</p>

<p>$ cd copy/x86_64/</p>

<p>$ ./CopyAgent &#8211;install (Donde pondremos nombre de usuario y contraseña del registro y carpeta a compartir. Por defecto Copy)</p>

<p>$ ./CopyConsole (Forzar actualizaciones)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[bzless]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/bzless/"/>
    <updated>2013-11-17T10:30:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/bzless</id>
    <content type="html"><![CDATA[<p>[bzip2]</p>

<p>Muestra el contenido de un archivo .bz2 comprimido con bzip2 de forma parecida al comando less [ver]</p>

<blockquote><p>$ bzless archivo.txt.bz2</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[bzexe]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/bzexe/"/>
    <updated>2013-11-17T10:30:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/bzexe</id>
    <content type="html"><![CDATA[<p>[bzip2]</p>

<p>Comprimir/descomprimir ejecutables.</p>

<blockquote><p># bzexe ejecutable</p>

<p># bzexe -d ejecutable (Descomprimir)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[lzma]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/lzma/"/>
    <updated>2013-11-17T08:12:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/lzma</id>
    <content type="html"><![CDATA[<p>Compresor/descompresor de archivos. Formato de salida .lzma</p>

<blockquote><p>$ lzma fichero.txt (Substituye fichero.txt por fichero.txt.lzma)</p>

<p>$ lzma -d fichero.txt.lzma (Descomprimir)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[lzip]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/lzip/"/>
    <updated>2013-11-17T08:12:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/lzip</id>
    <content type="html"><![CDATA[<p>compresor/descompresor de archivos. Formato de salida .lz</p>

<blockquote><p>$ lzip archivo.txt (Lo substituye por archivo.txt.lz)</p>

<p>$ lzip -d archivo.txt.lz (descomprimir)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[gunzip]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/gunzip/"/>
    <updated>2013-11-17T08:12:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/gunzip</id>
    <content type="html"><![CDATA[<p>Descomprime archivos gz comprimidos con gzip.</p>

<blockquote><p>$ gunzip archivo.txt.gz</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ts]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/ts/"/>
    <updated>2013-11-17T07:27:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/ts</id>
    <content type="html"><![CDATA[<p>[moreutils]</p>

<p>Añade una marca de tiempo al principio de cada línea de entrada.</p>

<blockquote><p>$ ts (Escribir cualquier cosa y al darle al intro mostrará la marca del tiempo y lo escrito)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[pee]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/pee/"/>
    <updated>2013-11-17T07:27:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/pee</id>
    <content type="html"><![CDATA[<p>[moreutils]</p>

<p>Parecido al comando tee [ver] ejecutando cada uno de los comandos</p>

<blockquote><p>$ pee ls pwd &#8220;ip a&#8221;</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[errno]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/errno/"/>
    <updated>2013-11-17T07:27:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/errno</id>
    <content type="html"><![CDATA[<p>[moreutils]</p>

<p>Muestra los errores de código y sus descripciones.</p>

<blockquote><p>$ errno -l (Todo el listado)</p>

<p>$ errno -s desconocido (Busca del listado el que contenga la descripción &#8220;desconocido&#8221;)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[compress]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/compress/"/>
    <updated>2013-11-17T07:27:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/compress</id>
    <content type="html"><![CDATA[<p>Comprimir archivos. Substituye el fichero orginal añadiendole .Z. Este comando es el compresor original de Unix. Su algoritmo de compresión es bastante primitivo, pero se mantiene por razones históricas de compatibilidad.</p>

<blockquote><p>$ compress fichero.txt (Creará fichero.txt.Z)</p>

<p>$ uncompress fichero.txt.Z (Descomprmir)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[chronic]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/chronic/"/>
    <updated>2013-11-17T07:27:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/chronic</id>
    <content type="html"><![CDATA[<p>[moreutils]</p>

<p>Mostrará el error por la salida estándar si el comando falla, tiene salida nula o se bloquea. Si el comando se ejecuta correctamente se ocultará cualquier salida.</p>

<blockquote><p>$ chronic ls (No mostrará nada porque el comando ls se ejecuta correctamente)</p>

<p>$ chronic lx (Mostrará el error)</p>

<p>$ chronic man (Mostrará que necesita otro dato)</p></blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[pvesh]]></title>
    <link href="https://tractatuslapipaplena.herokuapp.com/blog/pvesh/"/>
    <updated>2013-11-17T05:42:00+01:00</updated>
    <id>https://tractatuslapipaplena.herokuapp.com/blog/pvesh</id>
    <content type="html"><![CDATA[<p>ssh restrictivo propio de proxmox.</p>

<blockquote><p>$ pvesh get /nodes/virtual1/qemu (Obtener un listado de todas las máquinas virtuales)</p>

<p>$ pvesh create /nodes/virtual1/qemu/100/status/start (Arrancar la VM con id 100)</p>

<p>$ pvesh get /nodes/virtual1/qemu/100/config (Obtener toda la configuración de la VM con id 100)</p>

<p>$ pvesh delete /nodes/virtual1/qemu/100 (Borrar la máquina virtual con id 100)</p>

<p>$ pvesh get /nodes/virtual1/storage (Obtener la información de los <em>Storages</em>)</p>

<p>$ pvesh create /access/users -userid usuario@pve (Crear usuario)</p>

<p>$ pvesh delete /access/users/usuario@pve (Eliminar usuario)</p></blockquote>
]]></content>
  </entry>
  
</feed>
