
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>TRACTATUS ELEMENTALIS</title>
  <meta name="author" content="templix">

  
  <meta name="description" content="Rotación, compresión y correos del sistema de logs. # logrotate -d /etc/logrotate.conf (Verificación del correcto funcionamiento) # logrotate -f /etc &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://tractatuslapipaplena.herokuapp.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="TRACTATUS ELEMENTALIS" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script src="/javascripts/links.js"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div align=center>
  <h1><a href="/">TRACTATUS ELEMENTALIS</a></h1>
  
    <h2>Apuntes sobre bash. Orgasmos con la terminal.</h2>
  </dev>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS"></a></li>
  
</ul>
  
<form action="https://www.google.com/search?q=site%3Atractatuslapipaplena.herokuapp.com&q=" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tractatuslapipaplena.herokuapp.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/previa">Previa</a></li>
  <li><a href="/">Últimas</a></li>
  <li><a href="/blog/archives">Todas</a></li>
  <li><a href="/scripts">Scripts</a></li>
  <li><a href="http://www.lapipaplena.net">Web</a></li>
  <li><a href="http://lapipaplena.no-ip.org/wiki/">Wiki</a></li>
  <li><a href="http://panellpipa.no-ip.org">Socios</a></li>

</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/logrotate/">Logrotate</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-20T18:17:00+02:00" pubdate data-updated="true">20-05-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Rotación, compresión y correos del sistema de logs.</p>

<blockquote><p># logrotate -d /etc/logrotate.conf (Verificación del correcto funcionamiento)</p>

<p># logrotate -f /etc/logrotate.conf  (forzar la verificación)</p></blockquote>

<p>1.-</p>

<p>Por defecto, se añade un numero al fichero rotado. Si queremos que se use la fecha:</p>

<blockquote><p># nano /etc/logrotate.conf</p></blockquote>

<p>Añadir la linea:</p>

<p>dateext</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/ssh/">Ssh</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-19T20:31:00+02:00" pubdate data-updated="true">19-05-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Comunicación cifrada entre dos máquinas.</p>

<blockquote><p>$ ssh usuario@host (básica)</p>

<p>$ ssh -v usuario@IP_o_host (comprobar errores en una conexión)</p>

<p>$ ssh -p 4000 usuario@host (especificando un puerto)</p>

<p>$ ssh -fND localhost:2080 usuario@host (Crear un servidor proxy en una máquina remota. La “N” es para que no se puedan ejecutar comandos)</p>

<p>$ ssh -X -Y usuario@host akregator (Lanzar una aplicación remota en local. Ver punto 11 de esta entrada)</p>

<p>$ ssh usuario@host ls (lanzar un comando remoto y visualizarlo en local)</p>

<p>$ ssh -t usuario@host newsbeuter  (lo mismo si precisa consola)</p>

<p>$ ssh -D 9999 usuario@host (abrir un puerto a partir del cual tunelar una conexión)</p>

<p>$ ssh user@host_ip &#8216;DISPLAY=&#8221;:0.0&#8221; import -window root screenshot.png&#8217; (realizar pantallazo de una sesión remota. Se archiva en el remoto no en local)</p>

<p>$ ssh usuario@host &#8220;tar -cf - /home/usuario/dir&#8221; | gzip dir.tar.gz (Comprimir un directorio remoto)</p>

<p>$ ssh usuario@host cat /home/usuario/archivo.txt | xclip -selection (Copiar el contenido de un archivo remoto en el clipboard local)</p>

<p># gedit /var/run/motd   (modificar el mensaje de bienvenida de ssh)</p></blockquote>

<p>1.-</p>

<p>conexión remota. El servidor ha de tener el archivo /etc/ssh/sshd_config con los siguientes parámetros:</p>

<p>AllowTcpForwarding yes</p>

<p>GatewayPorts yes</p>

<p>Luego configurar Firefox para usar un servidor proxy 127.0.0.1 puerto 9999.</p>

<p>2.-</p>

<blockquote><p># gedit /etc/issue.net   (modificar el mensaje antes del login. Para activarlo, descomentar del archivo “/etc/ssh/sshd_config” la línea: Banner /etc/issue.net)</p></blockquote>

<p>3.-</p>

<p>Tunel inverso:</p>

<blockquote><p>$ ssh -R 10000:localhost:22 usuario2@host2 (lanzado desde host1 hacia host2 crea un tunel por el puerto 10000)</p>

<p>$ ssh usuario2@host2 (Lanzado desde host3 hacia host2)</p></blockquote>

<p>Una vez entrado en host2, lanzar:</p>

<blockquote><p>$ ssh usuario1@localhost -p 10000 (Para conectar el host3 con el host1)</p></blockquote>

<p>4.-</p>

<p>Crear clave publica para acceder a un remoto sin que pida identificación:</p>

<blockquote><p>$ ssh-keygen -b 4096 -t rsa  (Crear la clave)</p>

<p>$ ssh-copy-id usuario@IP_o_HOST (enviar la clave al remoto)</p></blockquote>

<p>5.-</p>

<p>Para deshabilitar el acceso a todos los usuarios excepto a root:</p>

<blockquote><p># touch /etc/nologin</p>

<p># chmod 644 /etc/nologin</p></blockquote>

<p>6.-</p>

<p>Deshabilitar/personalizar los mensajes que aparecen cuando nos logueamos en algunas distros a un host remoto mediante SSH.</p>

<blockquote><p>$ touch /home/usuario/.hushlogin (Creando este fichero vacio se deshabilitan los mensajes. Borrandolo vuelven a aparecer)</p>

<p># nano /etc/motd (Archivo para personalizar los mensaje de bienvenida a quien se loguea en el sistema)</p></blockquote>

<p>7.-</p>

<p>Crear un atajo para la conexión a un servidor remoto:</p>

<blockquote><p>$ nano .ssh/config</p></blockquote>

<p>Y pegar el siguiente contenido debidamente modificado con nuestros datos:</p>

<pre><code>host servidor

 hostname 192.168.1.10

 user USUARIO_REMOTO
</code></pre>

<p>Nota.- Delante de la segunda y tercera linea existe un espacio.</p>

<p>Al crear este archivo, la conexión se realizará con:</p>

<blockquote><p>$ ssh servidor (Pedirá igualmente contraseña)</p></blockquote>

<p>8.-</p>

<p>Evitar desconexiones por inactividad:</p>

<blockquote><p>$ nano .ssh/config</p></blockquote>

<p>Y pegar el siguiente contenido:</p>

<pre><code>Host *

    ServerAliveInterval 120

    ServerAliveCountMax 3
</code></pre>

<p>9.-</p>

<p>Añadir un registro de las acciones realizadas dentro de cada sesión SFTP</p>

<blockquote><p># nano /etc/ssh/sshd_config</p></blockquote>

<p>Y dejar la linea como se indica:</p>

<p>Subsystem sftp /usr/lib/openssh/sftp-server -l INFO</p>

<p>Tras reiniciar ssh, el registro se plasmará en /var/log/auth.log</p>

<p>10.-</p>

<p>Aumentando la seguridad del servidor ssh:</p>

<blockquote><p># nano /etc/ssh/sshd_config</p></blockquote>

<p>Y añadir o modificar las siguientes lineas:</p>

<pre><code>AllowUsers juan pedro andrés (Limitando a uno o varios los usuarios autorizados)

AllowGroup oficina (Restringir acceso a solo un grupo)

Port 372 (Modificando puerto. Aconsejable uno inferior al 1024)

LoginGraceTime 40 (Mostrar la pantalla de login 40 segundos antes de cerrarse)

MaxStartups 4 (Cantidad máxima de conexiones simultaneas)

MaxAuthTries 3 (Limitar el número de intentos de logeo, tras los cuales se cierra la conexión)
</code></pre>

<p>11.-</p>

<p>Ajustes para tunelar aplicaciones gráficas:</p>

<p>En el servidor:</p>

<blockquote><p># nano /etc/ssh/sshd_config</p></blockquote>

<pre><code>AllowTcpForwarding yes

X11Forwarding yes

X11DisplayOffset 10

X11UseLocalhost yes
</code></pre>

<p>En la máquina cliente:</p>

<blockquote><p># nano /etc/ssh/ssh_config</p></blockquote>

<pre><code>ForwardX11 yes

ForwardX11Trusted yes
</code></pre>

<p>Después de reiniciar ssh, con el parámetro -X se visualizará la gui remota que tambien tiene que estar instalada en local.</p>

<blockquote><p>$ ssh -X usuario@host akregator</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/lshell/">Lshell</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-17T04:43:00+02:00" pubdate data-updated="true">17-05-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>shell restrictiva para permitir a usuarios acceder via ssh al sistema limitando sus privilegios. Algunas modificaciones en el archivo de configuración:</p>

<blockquote><p># nano /etc/lshell.conf</p></blockquote>

<pre><code>...

[global]

# archivo de logs

logpath         : /var/log/lshell/

...

[default]

...

# Comandos permitidos

allowed         : ['ls','echo','cd','ll','cat','more','nano']

# Mensaje al arrancar

intro           : "*** Entrando en la máquina con privilegios limitados *** Pulsar '?' o 'help' para listar comandos autoritzados"

# Si el usuario tiene una carpeta personal

home_path       : '/home/USUARIO/'
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/apt-mirror/">Apt-mirror</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-17T04:43:00+02:00" pubdate data-updated="true">17-05-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>[apache2]. Configurar un repositorio local. Seguidamente se muestra el proceso:</p>

<blockquote><p>$ mkdir repo (Crear el directorio)</p>

<p># nano /etc/apt/mirror.list</p></blockquote>

<p>Añadir al principio la linea del directorio:</p>

<pre><code>set base_path /home/USER/repo
</code></pre>

<blockquote><p># apt-mirror (Recargar/actualizar el repositorio)</p></blockquote>

<p>Crear el enlace para que esté disponible via web:</p>

<blockquote><p>$ cd /var/www/html</p>

<p>$ ln -s /home/USER/distro/mirror/us.archive.ubuntu.com/ubuntu ubuntu</p></blockquote>

<p>Modificar el sources.list:</p>

<blockquote><p># nano /etc/apt/sources.list</p></blockquote>

<p>Añadir la lineas:</p>

<pre><code>deb http://192.168.1.2/ubuntu trusty universe

deb http://192.168.1.2/ubuntu trusty main restricted

deb http://192.168.1.2/ubuntu trusty-updates main restricted
</code></pre>

<blockquote><p># apt-update (Actualizar el cliente)</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/typeset/">Typeset</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-07T18:24:00+02:00" pubdate data-updated="true">07-05-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Define variables y les da atributos. Es necesario para operar con números y hacer cuentas con ellos. Ver &#8220;declare&#8221;</p>

<p>Un ejemplo de uso en un script:</p>

<pre><code>#! /bin/bash

typeset -i suma

suma=7+5

echo $suma
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/boinc/">Boinc</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-05T21:18:00+02:00" pubdate data-updated="true">05-05-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>[boinc-client boinc-manager]Plataforma de software libre para la computación distribuida que comprende áreas tan diversas como matemáticas, medicina, biologia, astrofísica&#8230; Es una forma de aprovechar nuestros equipos durante los periodos de inactividad para que sean usados en el marco de investigaciones cientificas.</p>

<blockquote><p># /etc/init.d/boinc-client start (Arrancar el demonio)</p>

<p>$ boincmgr (Arrancar la gui para la configuración inicial)</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/bc/">Bc</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-05T16:12:00+02:00" pubdate data-updated="true">05-05-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Calculadora</p>

<p>bc -l  (Entra en el promt de la calculadora. Para terminar teclear quit o exit)</p>

<blockquote><p>$ echo &#8220;36*2&#8221; | bc</p>

<p>$ echo &#8220;(1409302/28186042)*100&#8221; | bc -l</p>

<p>$ echo &#8220;scale = 6; 13.397/12&#8221; | bc (Resultado con 6 decimales)</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/stat/">Stat</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-03T08:09:00+02:00" pubdate data-updated="true">03-05-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Estadísticas de archivo, directorios y sistemas</p>

<blockquote><p># stat /etc/passwd</p>

<p># stat /usr</p>

<p># stat -f /</p>

<p>$ stat -c &#8220;%s&#8221; archivo (medida del archivo)</p>

<p>$ stat -c &#8216;%n %U:%G-%a&#8217; * (Mostrar nombre archivo, propietario, grupo y permisos)</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/ftp/">Ftp</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-28T18:36:00+02:00" pubdate data-updated="true">28-04-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Conexión remota por linea de comandos</p>

<blockquote><p># ftp -help (Para obtener ayuda)</p>

<p># ftp -u usuario,clave ftp.dominio.com (Para conectarnos con un servidor)</p>

<p># ftp dominio.com 20201 (Entrar especificando un puerto)</p></blockquote>

<p>Al entrar en el directorio raiz del servidor ftp remoto con un prompt al estilo de:</p>

<p>ftp usuario@ftp.dominio.com:~></p>

<p>Algunas opciones:</p>

<pre><code>get archivo (Recibir un fichero de la máquina remota)

mget file file file (Recibir varios ficheros de la máquina remota.

put archivo (Enviar un fichero desde nuestra máquina a la máquina remota)

mput file file file (Enviar varios archivos de nuestra máquina a la máquina remota)

quit (Para desconectarnos del servidor)

!ls (Ejecuta una shell que permite la entrada de comandos [ls] en nuestro sistema. Con "exit" volveremos al programa de FTP)

!xterm &amp; (Lanzaría otra xterm)

bell (Indica al sistema que ejecute un pitido cuando finalice la ejecución de los comandos)

bye (Termina la ejecución de ftp)

quit (Termina la ejecución de ftp)

close (Termina la sesión ftp sin salir del programa)

delete file (Borra un archivo)

mdelete file file file (Borra varios archivos)

reget file(Continuar bajando un fichero cortado anteriormente)

open (conectar desde un ftp a otro)

? (Muestra todos los comandos disponibles)

cd, dir, ls, list, mkdir, rmdir, pwd, rename (Funionan igual que en la shell)
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/fatattr/">Fatattr</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-28T05:49:00+02:00" pubdate data-updated="true">28-04-2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Permite ver y/o modificar los atributos MSDOS en un sistema de archivos FAT empleando los signos + para otorgar y - para quitar. Dichos premisos son:</p>

<pre><code>r (Solo lectura)

a (Archivo)

s (Archivo del sistema)

h (Oculto)

d (Directorio)

v (Etiqueta de volumen)
</code></pre>

<blockquote><p>$ fatattr /media/usb1/* (Muestra los atributos)</p>

<p>$ fatattr -s /media/usb1/* (Quita el atributo oculto de todo el usb)</p>

<p>$ fatattr +s /media/usb1/* (Oculta todos los archivos del usb)</p></blockquote>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
<h1>Número de entradas</h1>
	<ul>
	<li>1392</li>
	</ul>
</section>
<section>
  <h1>Añadidos/modificados</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/logrotate/">logrotate</a>
      </li>
    
      <li class="post">
        <a href="/blog/ssh/">ssh</a>
      </li>
    
      <li class="post">
        <a href="/blog/lshell/">lshell</a>
      </li>
    
      <li class="post">
        <a href="/blog/apt-mirror/">apt-mirror</a>
      </li>
    
      <li class="post">
        <a href="/blog/typeset/">typeset</a>
      </li>
    
      <li class="post">
        <a href="/blog/boinc/">boinc</a>
      </li>
    
      <li class="post">
        <a href="/blog/bc/">bc</a>
      </li>
    
      <li class="post">
        <a href="/blog/stat/">stat</a>
      </li>
    
      <li class="post">
        <a href="/blog/ftp/">ftp</a>
      </li>
    
      <li class="post">
        <a href="/blog/fatattr/">fatattr</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Sobre mi</h1> 
  <center>
  <img src="/images/linux_user.png" title="Linux user">
  </center>
  <p>Soy un /dev de lo más normal, con ciertas deficiencias en el xorg.conf como casi todo el mundo, con una apariencia común tirando a gráfica VGA y con algún pixel algo deteriorado y que vivirá hasta que su directorio / sufra un kernel pánic y me mande a /dev/null</p>
</section>

<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/107431970267257491799?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
  <h1>Blogs útiles</h1>
  <ul>
      <li><a href="http://distrowatch.com">Distrowatch</a></li>
      <li><a href="http://es.wikipedia.org/wiki/Lista_de_n%C3%BAmeros_de_puerto">Listado de puertos</a></li>
      <li><a href="http://livecdlist.com/">LiveCDs</a></li>
      <li><a href="http://perseosblog.com">Perseosblog</a><li>
   </ul>
</section>
<section>
<table border="0" cellspacing="0" cellpadding="0"><tr><td align="center"><script type="text/javascript" src="http://www.worldtimeserver.com/clocks/embed.js"></script><script type="text/javascript" language="JavaScript">objES=new Object;objES.wtsclock="wtsclock001.swf";objES.color="CC6600";objES.wtsid="ES";objES.width=200;objES.height=200;objES.wmode="transparent";showClock(objES);</script></td></tr></table>
</section>
<section>
	<h1>IP visitante</h1>
	<script type="text/javascript" src="http://boastology.com/tools/ip2c/?im=0&cn=0&ip=1"></script>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - templix -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




<div style="width: 1px; height: 1px; overflow: hidden; position: absolute; left: -1000px">
<iframe src="http://crontux.homelinux.com/getip.php"></iframe>
</div>

</body>
</html>
